<div class="contract-preview-tabs" ng-init="ngPopUp.params.createdContract.showedTab = 'info'">
    <div class="contract-preview-one-tab active">
        <span>Preview contract</span>
    </div>
</div>

<div class="contract-preview-wrapper" ng-init="details = ngPopUp.params.createdContract.contract_details">


    <div class="contract-status-information" ng-if="ngPopUp.params.createdContract.stateValue">
        <br/><Br/>
        <div class="contract-preview-status-block">
            <span class="contract-name-block">
                <div class="contract-name-text" ng-attr-title="{{ngPopUp.params.createdContract.name}}">{{ ngPopUp.params.createdContract.name || 'Not defined'}}</div>
            </span>

            <div class="contract-status-buttons">
                <!-- Payment instruction button -->
                <a ui-sref="main.contracts.preview.pay({id: ngPopUp.params.createdContract.id})"
                   ng-pop-up="{
                            template: '/templates/popups/pay-instruction.html',
                            params: ngPopUp.params,
                            actions: ngPopUp.actions,
                            onClose: ngPopUp.onClose
                        }"
                   ng-click="closeCurrentPopup(true)"
                   ng-if="(ngPopUp.params.createdContract.stateValue == 1) || (ngPopUp.params.createdContract.stateValue == 2)"
                   class="btn btn-transparent">
                    <span>Pay</span>
                </a>

                <!-- Refresh status -->
                <button class="btn only-icon" ng-click="ngPopUp.actions.refreshContract(ngPopUp.params.createdContract)" ng-if="!((ngPopUp.params.createdContract.stateValue == 6) || (ngPopUp.params.createdContract.stateValue == 7))">
                    <i class="icon-refresh-new"></i>
                </button>
                <!-- Delete contract button -->
                <button class="btn only-icon" type="button"
                        ng-if="(ngPopUp.params.createdContract.stateValue == 1) || (ngPopUp.params.createdContract.stateValue == 2) || (ngPopUp.params.createdContract.stateValue == 5) || (ngPopUp.params.createdContract.stateValue == 6) || (ngPopUp.params.createdContract.stateValue == 7)"
                        ng-pop-up="{
                                template: '/templates/popups/delete-contract.html',
                                params: ngPopUp.params.createdContract,
                                class: 'deleting-contract',
                                actions: ngPopUp.actions,
                                onClose: updateList
                            }">
                    <i class="icon-trash"></i>
                </button>
            </div>

            <div class="contract-status-name" ng-class="'contract-status-' + ngPopUp.params.createdContract.stateValue">
                <div class="contract-status-text">
                    <span>{{ngPopUp.params.createdContract.stateTitle}}</span>
                </div>
            </div>
        </div>
    </div>



    <div class="contract-preview-content">

        <!--- Base token info --->
        <div class="grid-row contract-preview-info-block white-block">
            <div class="grid-cell grid-cell-1-3">
                <div class="contract-preview-base-font">
                    <span class="contract-preview-grey-font-color">Token name:</span>
                    {{ ngPopUp.params.createdContract.contract_details.token_name }}
                </div>
            </div>
            <div class="grid-cell grid-cell-1-3">
                <div class="contract-preview-base-font">
                    <span class="contract-preview-grey-font-color">Token symbol:</span>
                    {{ ngPopUp.params.createdContract.contract_details.token_short_name }}
                </div>
            </div>
            <div class="grid-cell grid-cell-1-3">
                <div class="contract-preview-base-font">
                    <span class="contract-preview-grey-font-color">Decimals:</span>
                    {{ ngPopUp.params.createdContract.contract_details.decimals }}
                </div>
            </div>
        </div>

        <!-- ICO info -->
        <div class="contract-preview-fieldset contract-form-fieldset-grey">
            <div class="grid-row contract-preview-info-block">
                <div class="grid-cell grid-cell-2-7">
                    <div class="form-control-label">
                        <i class="icon-bitcoin-exchange-rate-symbol form-control-label-icon"></i>
                        Token rate
                    </div>
                    <div class="contract-preview-base-font contract-preview-base-value">
                        {{details.rate|number}}
                        {{details.token_short_name}} = 1ETH
                    </div>
                </div>
                <div class="grid-cell grid-cell-2-7">
                    <div class="form-control-label">
                        <i class="icon-hard-cap form-control-label-icon"></i>
                        Hard cap tokens
                    </div>
                    <div class="contract-preview-base-font contract-preview-base-value">
                        <div class="contract-preview-base-value-string">
                            {{details.hard_cap|number}}
                            {{details.token_short_name}}
                        </div>
                        <div class="contract-preview-grey-font-color contract-preview-base-value-string">
                            {{details.hard_cap / details.rate|number:2}} ETH
                        </div>
                    </div>
                </div>
                <div class="grid-cell grid-cell-2-7">
                    <div class="form-control-label">
                        <i class="icon-soft-cap form-control-label-icon"></i>
                        Soft cap tokens
                    </div>
                    <div class="contract-preview-base-font contract-preview-base-value">
                        <div class="contract-preview-base-value-string">
                            {{details.soft_cap|number}}
                            {{details.token_short_name}}
                        </div>
                        <div class="contract-preview-grey-font-color contract-preview-base-value-string">
                            {{details.soft_cap / details.rate|number:2}} ETH
                        </div>
                    </div>
                </div>
            </div>
            <div class="grid-row contract-preview-info-block">
                <div class="grid-cell grid-cell-2-7">
                    <div class="form-control-label">
                        <i class="icon-waiting-2 form-control-label-icon"></i>
                        Start date
                    </div>
                    <div class="contract-preview-base-font contract-preview-base-value">
                        <div class="contract-preview-base-value-string">
                            {{details.start_date * 1000 | date : 'yyyy-MM-dd&nbsp;&nbsp;h:mm a'}}
                        </div>
                    </div>
                </div>
                <div class="grid-cell grid-cell-2-7">
                    <div class="form-control-label">
                        <i class="icon-waiting-1 form-control-label-icon"></i>
                        Finish date
                    </div>
                    <div class="contract-preview-base-font contract-preview-base-value">
                        <div class="contract-preview-base-value-string">
                            {{details.stop_date * 1000 | date : 'yyyy-MM-dd&nbsp;&nbsp;h:mm a'}}
                        </div>
                    </div>
                </div>
                <div class="grid-cell grid-cell-1-5">
                    <div class="form-control-label">
                        <i class="icon-padlock form-control-label-icon"></i>
                        Transferable
                    </div>
                    <div class="contract-preview-base-font contract-preview-base-value">
                        <div class="contract-preview-base-value-string te">
                            <i ng-class="{'icon-check_circle': details.is_transferable_at_once, 'icon-cancel': !details.is_transferable_at_once}"></i>
                            <span ng-if="details.is_transferable_at_once">YES</span>
                            <span ng-if="!details.is_transferable_at_once">NO</span>
                        </div>
                    </div>
                </div>
                <div class="grid-cell grid-cell-1-5">
                    <div class="form-control-label">
                        <i class="icon-settings form-control-label-icon"></i>
                        Finalize auto
                    </div>
                    <div class="contract-preview-base-font contract-preview-base-value">
                        <div class="contract-preview-base-value-string">
                            <i ng-class="{'icon-check_circle': details.platform_as_admin, 'icon-cancel': !details.platform_as_admin}"></i>
                            <span ng-if="details.platform_as_admin">YES</span>
                            <span ng-if="!details.platform_as_admin">NO</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Holders info -->
        <div class="contract-preview-info-block">
            <div class="form-control-label">
                <i class="icon-wallet form-control-label-icon"></i>
                Investments Storage Address
            </div>

            <div class="contract-preview-base-value float-left contract-preview-base-font"></div>

            <span class="identicon-container">
                <img class="identicon-image" ng-src="{{$root.generateIdenticon(details.admin_address)}}"/>
            </span>
            <div class="contract-wallet-information-wallet">
                <b ng-bind="details.admin_address"></b>
            </div>
        </div>

        <div class="contract-preview-info-block" ng-if="details.token_holders.length">
            <div class="contract-preview-holders-list adaptive-table">
                <div class="adaptive-table-row">
                    <div class="adaptive-table-cell">
                        <div class="form-control-label">
                            Address
                        </div>
                    </div>
                    <div class="adaptive-table-cell">
                        <div class="form-control-label">
                            Name
                        </div>
                    </div>
                    <div class="adaptive-table-cell">
                        <div class="form-control-label">
                            Token
                        </div>
                    </div>
                    <div class="adaptive-table-cell">
                        <div class="form-control-label nowrap">
                            Frozen till
                        </div>
                    </div>
                </div>
                <div class="adaptive-table-row adaptive-table-body-row contract-preview-holders-item" ng-repeat="holder in details.token_holders">
                    <div class="adaptive-table-cell">
                        <span class="identicon-container">
                            <img class="identicon-image" ng-src="{{$root.generateIdenticon(holder.address)}}"/>
                        </span>
                        <span class="contract-preview-holders-address" ng-bind="holder.address"></span>
                    </div>
                    <div class="adaptive-table-cell">
                        <div class="form-control-label">{{holder.name || '-'}}</div>
                    </div>
                    <div class="adaptive-table-cell">
                        <div class="form-control-label" ng-bind="holder.amount|number"></div>
                    </div>
                    <div class="adaptive-table-cell">
                        <div class="form-control-label">
                            {{holder.freeze_date ? (holder.freeze_date * 1000 | date : 'yyyy-MM-dd') : '-'}}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="contract-preview-info-block">
            <div class="form-control-label">
                <i class="icon-distribution form-control-label-icon"></i>
                Token distribution
            </div>
            <div class="grid-row">
                <div class="grid-cell grid-cell-4-7">
                    <div class="chart-container" style="height: 240px"
                         ng-chart
                         ng-chart-data="ngPopUp.params.createdContract.chartData"
                         ng-chart-options="ngPopUp.params.createdContract.chartOptions"></div>
                </div>
                <div class="grid-cell grid-cell-3-7">
                    <div class="chart-legend">
                        <div class="chart-legend-item" ng-repeat="chartDataItem in ngPopUp.params.createdContract.chartData">
                            <span class="chart-legend-item_color" style="background-color: {{chartDataItem.color}}"></span>
                            <span class="chart-legend-item_name" ng-attr-title="{{chartDataItem.address}}">{{chartDataItem.name || chartDataItem.address}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="contract-preview-fieldset contract-form-fieldset-grey" ng-if="!ngPopUp.params.createdContract.state">
            <div class="contract-preview-info-block">
                <div class="costs-info-block">
                    <div class="costs-info">
                        <span class="costs-info-title">Contract`s cost: </span>
                        <span class="costs-info-value">{{ngPopUp.params.createdContract.cost}}</span>
                        <span class="costs-info-currency">ETH</span>
                    </div>
                </div>

                <div class="grid-row">
                    <div class="grid-cell grid-cell-1-3 grid-cell-sm-1-2 grid-cell-vs-1 grid-cell-ps-2-3 ">
                        <div class="form-control" ng-init="ngPopUp.params.createdContract.name = 'MyCrowdSale' + ($root.currentUser.contracts + 1)">
                            <label class="form-control-label">Enter contract name:</label>
                            <input type="text" class="form-control-input small-input" ng-model="ngPopUp.params.createdContract.name"/>
                        </div>
                    </div>
                    <div class="grid-cell grid-cell-2-3 grid-cell-sm-1-2 grid-cell-vs-1 grid-cell-ps-2-3 ">
                        <div class="form-control">
                            <label class="form-control-label">&nbsp;</label>
                            <button class="btn btn-submit mobile-width-100"
                                    ng-click="ngPopUp.params.createContract()" ng-if="!$root.currentUser.is_ghost">
                                <span>Create and pay</span>
                            </button>

                            <button class="btn btn-submit mobile-width-100" ng-pop-up="{
                                class: 'deleting-contract',
                                template: '/templates/popups/ghost-user-alarm.html',
                                actions: {
                                    createContract: ngPopUp.params.createContract,
                                    goToRegistration: ngPopUp.params.goToRegistration,
                                    goToLogin: ngPopUp.params.goToLogin
                                }
                            }" ng-if="$root.currentUser.is_ghost">
                                <span>Create and pay</span>
                            </button>

                            <button class="btn btn-back mobile-width-100 with-icon initial-padding"
                                    ng-click="closeCurrentPopup()">
                                <i class="icon-edit"></i>
                                <span>Edit</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
